syntax = "proto3";

package family;

option java_multiple_files = true;
option java_package = "family";
option java_outer_classname = "FamilyProto";


message NodeInfo {
  string host = 1;
  int32 port = 2;
}


message FamilyView {
  repeated NodeInfo members = 1;
}

message Empty {}

message ChatMessage {
  string text = 1;
  string fromHost = 2;
  int32 fromPort = 3;
  int64 timestamp = 4;
}


service FamilyService {
  rpc Join(NodeInfo) returns (FamilyView);
  rpc Leave(NodeInfo) returns (Empty);
  rpc GetFamily(Empty) returns (FamilyView);
  rpc Heartbeat(NodeInfo) returns (Empty);
  rpc ReceiveChat(ChatMessage) returns (Empty);
  rpc GetStats(Empty) returns (MessageStats);
}

message MessageStats {
  int64 messageCount = 1;
}

// --- Mesaj kayıt sistemi için ek tanımlar ---

message StoredMessage {
  int32 id = 1;
  string text = 2;
}

message MessageId {
  int32 id = 1;
}

message StoreResult {
  string status = 1;
}

service StorageService {
  rpc Store(StoredMessage) returns (StoreResult);
  rpc Retrieve(MessageId) returns (StoredMessage);
}

